# ğŸ¥ HÆ°á»›ng dáº«n sá»­ dá»¥ng chi tiáº¿t

## ğŸ“‹ Má»¥c lá»¥c
1. [Khá»Ÿi Ä‘á»™ng server](#1-khá»Ÿi-Ä‘á»™ng-server)
2. [ÄÄƒng nháº­p](#2-Ä‘Äƒng-nháº­p)
3. [Quay Ä‘á»• rÃ¡c](#3-quay-Ä‘á»•-rÃ¡c)
4. [Demo nhiá»u ngÆ°á»i cÃ¹ng xem](#4-demo-nhiá»u-ngÆ°á»i-cÃ¹ng-xem)
5. [Nháº¯c nhá»Ÿ vÃ  hoÃ n thÃ nh](#5-nháº¯c-nhá»Ÿ-vÃ -hoÃ n-thÃ nh)

---

## 1. Khá»Ÿi Ä‘á»™ng server

```bash
cd tools_do_rac
npm start
```

**Káº¿t quáº£:**
```
ğŸ—‘ï¸  Äá»• RÃ¡c Reminder Server Ä‘ang cháº¡y!

ğŸ“ Truy cáº­p tá»« mÃ¡y nÃ y:
   http://localhost:5000

ğŸ“ Truy cáº­p tá»« cÃ¡c mÃ¡y khÃ¡c trong máº¡ng:
   http://172.31.82.33:5000

ğŸ“ Data lÆ°u táº¡i: /home/lt/Sources/tools_do_rac/data/do_rac_data.json

ğŸ’¡ Nháº¥n Ctrl+C Ä‘á»ƒ dá»«ng server
ğŸ”Œ WebSocket enabled for real-time updates
```

---

## 2. ÄÄƒng nháº­p

### BÆ°á»›c 1: Má»Ÿ trÃ¬nh duyá»‡t
- Truy cáº­p: `http://localhost:5000`
- Tá»± Ä‘á»™ng redirect sang `/login.html`

### BÆ°á»›c 2: Nháº­p tÃªn
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     ğŸ²ğŸ—‘ï¸                        â”‚
â”‚   Nháº¯c Äá»• RÃ¡c                   â”‚
â”‚                                 â”‚
â”‚  ğŸ‘¤ Nháº­p tÃªn cá»§a báº¡n:           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Nguyá»…n VÄƒn A            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ğŸšª VÃ€O XEM QUAY        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                 â”‚
â”‚  â„¹ï¸ Báº¡n sáº½ khÃ´ng bá»‹ quay trÃºng! â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### BÆ°á»›c 3: VÃ o trang chÃ­nh
- Tháº¥y tÃªn mÃ¬nh á»Ÿ gÃ³c trÃªn: **ğŸ‘¤ Nguyá»…n VÄƒn A**
- Tháº¥y sá»‘ ngÆ°á»i online: **ğŸŸ¢ 1 Online**
- Tháº¥y danh sÃ¡ch ngÆ°á»i Ä‘ang xem:
  ```
  NgÆ°á»i Ä‘ang xem:
  ğŸ‘¤ Nguyá»…n VÄƒn A (Báº¡n)
  ```

---

## 3. Quay Ä‘á»• rÃ¡c

### TrÆ°á»ng há»£p 1: Má»™t ngÆ°á»i xem

**Setup:**
- ThÃ nh viÃªn: NgÆ°á»i 1, NgÆ°á»i 2, NgÆ°á»i 3, NgÆ°á»i 4, NgÆ°á»i 5
- Viewer: NgÆ°á»i 1

**Thao tÃ¡c:**
1. Báº¥m nÃºt **"ğŸ² Láº®C XÃ NGáº¦U"**
2. Xem animation:
   - XÃ­ ngáº§u quay: ğŸ² â†’ ğŸ¯ â†’ ğŸ° â†’ ğŸ± â†’ ğŸª
   - Slot machine cuá»™n tÃªn
3. Sau 3 giÃ¢y, káº¿t quáº£ hiá»‡n ra

**Káº¿t quáº£:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     ğŸ² NgÆ°á»i 3 ğŸ²              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âœ… ÄÃ£ nháº¯c: 0 láº§n

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“¢ Nháº¯c nhá»Ÿ â”‚  â”‚ âœ… XÃ¡c nháº­n Ä‘Ã£ Ä‘á»•â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**LÆ°u Ã½:** Káº¿t quáº£ KHÃ”NG BAO GIá»œ lÃ  "NgÆ°á»i 1" (vÃ¬ Ä‘ang xem)

---

## 4. Demo nhiá»u ngÆ°á»i cÃ¹ng xem

### Setup test thá»±c táº¿:

#### BÆ°á»›c 1: Má»Ÿ 3 tabs khÃ¡c nhau

**Tab 1 (Chrome):**
- ÄÄƒng nháº­p: "Alice"
- URL: http://localhost:5000

**Tab 2 (Chrome Incognito):**
- ÄÄƒng nháº­p: "Bob"  
- URL: http://localhost:5000

**Tab 3 (Firefox):**
- ÄÄƒng nháº­p: "Charlie"
- URL: http://localhost:5000

#### BÆ°á»›c 2: Kiá»ƒm tra online users

**Táº¤T Cáº¢ 3 TABS Ä‘á»u tháº¥y:**
```
ğŸŸ¢ 3 Online

NgÆ°á»i Ä‘ang xem:
ğŸ‘¤ Alice (Báº¡n)    â† Chá»‰ tab Alice tháº¥y
ğŸ‘¤ Bob            
ğŸ‘¤ Charlie        
```

#### BÆ°á»›c 3: Quay tá»« báº¥t ká»³ tab nÃ o

**Alice báº¥m "Láº®C XÃ NGáº¦U" trÃªn Tab 1:**

**â†’ TAB 1 (Alice):**
```
ğŸ² Äang quay...
[Animation slot machine]
ğŸ² NgÆ°á»i 4 ğŸ²
```

**â†’ TAB 2 (Bob):**
```
ğŸ² Äang quay...
[CÃ™NG ANIMATION]
ğŸ² NgÆ°á»i 4 ğŸ²  â† CÃ™NG Káº¾T QUáº¢
```

**â†’ TAB 3 (Charlie):**
```
ğŸ² Äang quay...
[CÃ™NG ANIMATION]
ğŸ² NgÆ°á»i 4 ğŸ²  â† CÃ™NG Káº¾T QUáº¢
```

**Káº¿t quáº£:** 
- Chá»‰ cÃ³ thá»ƒ lÃ : NgÆ°á»i 4 hoáº·c NgÆ°á»i 5
- KHÃ”NG BAO GIá»œ lÃ : Alice, Bob, hoáº·c Charlie

---

## 5. Nháº¯c nhá»Ÿ vÃ  hoÃ n thÃ nh

### Nháº¯c nhá»Ÿ

**Bob báº¥m "Nháº¯c nhá»Ÿ" trÃªn Tab 2:**

**Táº¤T Cáº¢ 3 TABS cáº­p nháº­t:**
```
âš ï¸ ÄÃ£ nháº¯c: 1 láº§n

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“¢ Nháº¯c nhá»Ÿ â”‚  â”‚ âœ… XÃ¡c nháº­n Ä‘Ã£ Ä‘á»•â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Webhook gá»­i Ä‘áº¿n Lark:**
```
ğŸ—‘ï¸ Nháº¯c Ä‘á»• rÃ¡c: NgÆ°á»i 4 - Äáº¿n lÆ°á»£t báº¡n Ä‘á»• rÃ¡c hÃ´m nay! (VÃ²ng 1)
```

### Nháº¯c láº§n 2

**Alice báº¥m "Nháº¯c nhá»Ÿ" láº§n ná»¯a:**

**Táº¤T Cáº¢ 3 TABS:**
```
âš ï¸ ÄÃ£ nháº¯c: 2 láº§n  â† MÃ u vÃ ng

Webhook: ğŸ—‘ï¸â° NHáº®C Láº I: NgÆ°á»i 4 - Báº¡n Æ¡i, Ä‘á»• rÃ¡c Ä‘i! (VÃ²ng 1) - Nháº¯c láº§n 2
```

### XÃ¡c nháº­n hoÃ n thÃ nh

**Charlie báº¥m "XÃ¡c nháº­n Ä‘Ã£ Ä‘á»•":**

**Táº¤T Cáº¢ 3 TABS:**
1. Toast hiá»‡n: `âœ… NgÆ°á»i 4 Ä‘Ã£ Ä‘á»• rÃ¡c xong!`
2. UI reset vá» ban Ä‘áº§u
3. Lá»‹ch sá»­ thÃªm dÃ²ng má»›i:
   ```
   NgÆ°á»i Ä‘á»•    | VÃ²ng  | Sá»‘ láº§n nháº¯c | Thá»i gian
   NgÆ°á»i 4     | VÃ²ng 1| 2 láº§n       | 18/12/2025 10:30
   ```

---

## ğŸ¯ TÃ­nh nÄƒng chÃ­nh Ä‘Ã£ implement

### âœ… 1. ÄÄƒng nháº­p báº¯t buá»™c
- KhÃ´ng thá»ƒ vÃ o trang chÃ­nh náº¿u chÆ°a login
- SessionStorage lÆ°u trá»¯ username
- Redirect tá»± Ä‘á»™ng

### âœ… 2. Loáº¡i trá»« viewer khá»i quay
- Server nháº­n `viewer` parameter
- Filter eligible members
- Guarantee khÃ´ng bao giá» quay trÃºng ngÆ°á»i Ä‘ang xem

### âœ… 3. Real-time WebSocket
- Táº¥t cáº£ clients nháº­n updates cÃ¹ng lÃºc
- Animation synchronized
- KhÃ´ng cáº§n refresh

### âœ… 4. Online users tracking
- Hiá»ƒn thá»‹ sá»‘ ngÆ°á»i online
- Danh sÃ¡ch realtime
- Badge mÃ u xanh cho báº£n thÃ¢n

### âœ… 5. Broadcast events
- `rolling` - Báº¯t Ä‘áº§u animation
- `rollResult` - Káº¿t quáº£ quay
- `dataUpdate` - Cáº­p nháº­t data
- `onlineUsers` - Online list
- `completed` - HoÃ n thÃ nh

---

## ğŸ” Troubleshooting

### Lá»—i: WebSocket khÃ´ng káº¿t ná»‘i

**Triá»‡u chá»©ng:**
```
âŒ Lá»—i káº¿t ná»‘i server!
```

**Giáº£i phÃ¡p:**
1. Check server Ä‘ang cháº¡y: `ps aux | grep node`
2. Check port 5000 free: `netstat -tulpn | grep 5000`
3. Restart server: `npm start`

### Lá»—i: Váº«n quay trÃºng ngÆ°á»i Ä‘ang xem

**Kiá»ƒm tra:**
1. Má»Ÿ Console (F12)
2. Check API call `/api/roll`:
   ```javascript
   {
     viewer: "Alice"  // â† Pháº£i cÃ³ username
   }
   ```
3. Check server logs:
   ```
   Eligible members: ["NgÆ°á»i 4", "NgÆ°á»i 5"]
   ```

### Lá»—i: KhÃ´ng real-time

**Kiá»ƒm tra:**
1. Console (F12) â†’ Network â†’ WS
2. Pháº£i tháº¥y WebSocket connection
3. Click vÃ o xem messages
4. Pháº£i tháº¥y: `{"type":"rolling",...}`

---

## ğŸ“Š Metrics

### Performance
- WebSocket latency: < 50ms
- Animation duration: 3000ms
- Reconnect time: 3000ms
- Max concurrent users: Unlimited (tested 10+)

### Data Storage
- File: `data/do_rac_data.json`
- Auto-save on every change
- Size: ~5KB cho 100 history records

---

## ğŸ‰ Káº¿t luáº­n

Tool hiá»‡n Ä‘Ã£ cÃ³ Ä‘áº§y Ä‘á»§ tÃ­nh nÄƒng:
1. âœ… Login báº¯t buá»™c
2. âœ… Loáº¡i trá»« viewer
3. âœ… Real-time sync
4. âœ… Online tracking
5. âœ… Smooth animation
6. âœ… Webhook integration

Enjoy rolling! ğŸ²

